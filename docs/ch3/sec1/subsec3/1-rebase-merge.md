# Git Rebase vs. Git Mergeï¼šé€‰å“ªä¸ªï¼ŸğŸ¤”

**ç›®çš„ï¼š**ææ‡‚ Git è¿™ä¸¤ç§åˆå¹¶åˆ†æ”¯çš„é…·ç‚«æ–¹å¼ï¼Œä»¥ååˆå¹¶ä»£ç ä¸å†çº ç»“ï¼

**å†…å®¹ï¼š**

å’±ä»¬å…ˆä¸è®²é‚£äº›å¤æ‚çš„ç†è®ºï¼Œç›´æ¥ä¸Šä¾‹å­ï¼Œä¿è¯ä½ ä¸€çœ‹å°±æ˜ç™½ï¼

## å…ˆæ‡‚ä¸¤ä¸ªåŸºç¡€æ¦‚å¿µ ğŸ”

**åˆ†æ”¯ (Branch)**ï¼šå°±åƒæ¸¸æˆé‡Œçš„å­˜æ¡£ç‚¹ï¼Œä½ å¯ä»¥ç‹¬ç«‹å¼€å‘åŠŸèƒ½è€Œä¸å½±å“ä¸»çº¿  
**æäº¤ (Commit)**ï¼šæ¯æ¬¡ä»£ç å˜åŠ¨çš„å­˜æ¡£è®°å½•ï¼ŒåŒ…å«ä½œè€…/æ—¶é—´/ä¿®æ”¹å†…å®¹

## åœºæ™¯æ¨¡æ‹Ÿï¼šå›¢é˜Ÿåˆä½œå¼€å‘æ–°åŠŸèƒ½ ğŸš€

å‡è®¾ä½ å’Œå°ä¼™ä¼´ä»¬æ­£åœ¨ä¸€èµ·å¼€å‘ä¸€ä¸ªè¶…é…·ç‚«çš„æ–°åŠŸèƒ½ï¼Œæ¯ä¸ªäººè´Ÿè´£ä¸€éƒ¨åˆ†ï¼š

* **ä½ ï¼š**è´Ÿè´£å¼€å‘ç”¨æˆ·ç™»å½•ç•Œé¢ (åœ¨ `feature/login` åˆ†æ”¯)
* **å°ä¼™ä¼´ Aï¼š**è´Ÿè´£å¼€å‘å•†å“å±•ç¤ºé¡µé¢ (åœ¨ `feature/product` åˆ†æ”¯)
* **ä¸»åˆ†æ”¯ï¼š**`main` åˆ†æ”¯ï¼Œæ˜¯å¤§å®¶å…±åŒçš„åŸºç¡€

### Git Mergeï¼šç®€å•ç²—æš´ï¼Œå†å²å…¨è®°å½• ğŸ“–

1. **ä½ å®Œæˆäº†ç™»å½•ç•Œé¢çš„å¼€å‘ï¼Œæƒ³è¦æŠŠä»£ç åˆå¹¶åˆ° `main` åˆ†æ”¯ï¼š**

    ```bash
    git checkout main  # åˆ‡æ¢åˆ° main åˆ†æ”¯
    git merge feature/login  # æŠŠ feature/login åˆ†æ”¯åˆå¹¶åˆ° main åˆ†æ”¯
    ```

    * **ç»“æœï¼š**Git ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆå¹¶æäº¤ï¼ˆmerge commitï¼‰ï¼ŒæŠŠä½ çš„ `feature/login` åˆ†æ”¯å’Œ `main` åˆ†æ”¯çš„æœ€æ–°ä»£ç åˆå¹¶åœ¨ä¸€èµ·ã€‚

    * **ç‰¹ç‚¹ï¼š**ç®€å•ï¼`main` åˆ†æ”¯çš„å†å²è®°å½•ä¼šå®Œæ•´ä¿ç•™æ‰€æœ‰åˆ†æ”¯çš„å¼€å‘è¿‡ç¨‹ï¼Œå°±åƒä¸€æœ¬è¯¦ç»†çš„æ—¥è®°ã€‚

2. **å°ä¼™ä¼´ A ä¹Ÿå®Œæˆäº†å•†å“å±•ç¤ºé¡µé¢çš„å¼€å‘ï¼ŒåŒæ ·åˆå¹¶åˆ° `main` åˆ†æ”¯ï¼š**

    ```bash
    git checkout main
    git merge feature/product
    ```

    * **ç»“æœï¼š**åˆå¤šäº†ä¸€ä¸ªåˆå¹¶æäº¤ï¼

    * **æ½œåœ¨é—®é¢˜ï¼š**å¦‚æœå¾ˆå¤šäººéƒ½åœ¨ä¸åŒçš„åˆ†æ”¯ä¸Šå¼€å‘ï¼Œ`main` åˆ†æ”¯çš„å†å²è®°å½•å¯èƒ½ä¼šå˜å¾—å¾ˆä¹±ï¼Œåƒèœ˜è››ç½‘ä¸€æ · ğŸ•¸ï¸ã€‚

### Git Rebaseï¼šä¹¾å¤å¤§æŒªç§»ï¼Œå†å²æ›´æ¸…æ™° âœ¨

1. **ä½ å®Œæˆäº†ç™»å½•ç•Œé¢çš„å¼€å‘ï¼Œè¿™æ¬¡å’±ä»¬ç”¨ `rebase`ï¼š**

    ```bash
    git checkout feature/login  # åˆ‡æ¢åˆ° feature/login åˆ†æ”¯
    git rebase main  # æŠŠ main åˆ†æ”¯çš„æœ€æ–°ä»£ç â€œå«â€åˆ°ä½ çš„ feature/login åˆ†æ”¯ä¸‹é¢
    git checkout main
    git merge feature/login # å¿«é€Ÿå‘å‰åˆå¹¶
    ```

    * **ç»“æœï¼š**
        * `rebase` ä¼šæŠŠä½ çš„ `feature/login` åˆ†æ”¯ä¸Šçš„æäº¤â€œç§»åŠ¨â€åˆ° `main` åˆ†æ”¯çš„æœ€æ–°æäº¤ä¹‹åã€‚å°±åƒæ˜¯æŠŠä½ çš„åˆ†æ”¯â€œå«æ¥â€åˆ°äº† `main` åˆ†æ”¯ä¸Šã€‚
        * ç„¶åå†æ¬¡åœ¨ `main` è¿›è¡Œ `merge` æ—¶ï¼Œç”±äº `feature/login` æ˜¯ç›´æ¥ä» `main` åˆ†æ”¯â€œç”Ÿé•¿â€å‡ºæ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¿«é€Ÿåˆå¹¶ï¼ˆfast-forwardï¼‰ï¼Œä¸ä¼šäº§ç”Ÿé¢å¤–çš„åˆå¹¶æäº¤ã€‚

    * **ç‰¹ç‚¹ï¼š**å¹²å‡€ï¼`main` åˆ†æ”¯çš„å†å²è®°å½•ä¼šæ˜¯ä¸€æ¡ç›´çº¿ï¼Œéå¸¸æ¸…æ™°ã€‚

2. **å°ä¼™ä¼´ A ä¹Ÿç”¨ `rebase` åˆå¹¶ï¼š**

    ```bash
    git checkout feature/product
    git rebase main
    git checkout main
    git merge feature/product #å¿«é€Ÿå‘å‰åˆå¹¶
    ```

    * **ç»“æœï¼š**åŒæ ·ï¼Œ`main` åˆ†æ”¯çš„å†å²è®°å½•ä¾ç„¶ä¿æŒä¸€æ¡ç›´çº¿ã€‚

    * **æ½œåœ¨é—®é¢˜ï¼š**`rebase` ä¼šæ”¹å†™æäº¤å†å²ï¼Œå¦‚æœä½ å·²ç»æŠŠ `feature/login` åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œå¹¶ä¸”å…¶ä»–äººåœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šå·¥ä½œï¼Œå°±ä¸è¦ç”¨ `rebase` äº†ï¼Œå¦åˆ™ä¼šé€ æˆæ··ä¹±ã€‚

> **å›¾è§£å˜åŸº**ï¼š
> ä¸»åˆ†æ”¯ï¼šA â€” B â€” C  
> ä½ çš„åˆ†æ”¯ï¼šA â€” D â€” E  
> `git rebase main` åï¼š  
> ä¸»åˆ†æ”¯ï¼šA â€” B â€” C  
> ä½ çš„åˆ†æ”¯å˜ä¸ºï¼šA â€” B â€” C â€” D' â€” E'  
> (ä½ çš„æäº¤è¢«"æ¬"åˆ°æœ€æ–°ä¸»å¹²ä¹‹å)

## **ğŸ’¡ é‡åˆ°ä»£ç å†²çªæ€ä¹ˆåŠï¼Ÿ**  

ä¸¤ç§æ–¹å¼éƒ½ä¼šå‡ºç°å†²çªï¼Œè§£å†³æ–¹å¼ä¸åŒï¼š

**Merge å†²çª**ï¼šè§£å†³ä¸€æ¬¡å†²çªï¼Œç”Ÿæˆåˆå¹¶æäº¤  
**Rebase å†²çª**ï¼šå¯èƒ½éœ€å¤šæ¬¡è§£å†³ï¼ˆæ¯ä¸ªè¢«ç§»åŠ¨çš„æäº¤éƒ½å¯èƒ½å†²çªï¼‰

æ¨èæ–°æ‰‹å…ˆç”¨ `git mergetool` å¯è§†åŒ–å·¥å…·å¤„ç†å†²çª

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ ğŸš¦

| åœºæ™¯                | Merge æ–¹æ¡ˆ               | Rebase æ–¹æ¡ˆ                 |
|---------------------|-------------------------|---------------------------|
| ä¸ªäººæœ¬åœ°åˆ†æ”¯åˆå¹¶     | `git merge feature`     | `git rebase main`         |
| æ¨é€å…±äº«åˆ†æ”¯         | âœ… å®‰å…¨                 | âŒ ç¦æ­¢ (ä¼šæ”¹å†™å†å²)        |
| æ›´æ–°æœ¬åœ°åˆ†æ”¯         | `git pull` (é»˜è®¤ merge)  | `git pull --rebase`       |
| æ”¾å¼ƒå½“å‰æ“ä½œ         | `git merge --abort`     | `git rebase --abort`      |

## æ€»ç»“ï¼šé€‰å“ªä¸ªï¼Ÿ

| ç‰¹æ€§         | Git Merge                                                                                             | Git Rebase                                                                                                                  |
| :----------- | :---------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------ |
| å†å²è®°å½•     | å®Œæ•´ï¼ŒåŒ…å«æ‰€æœ‰åˆ†æ”¯çš„å¼€å‘è¿‡ç¨‹                                                                                    | ç®€æ´ï¼Œä¸€æ¡ç›´çº¿                                                                                                                |
| æ“ä½œéš¾åº¦     | ç®€å•                                                                                                 | ç¨å¤æ‚ï¼Œéœ€è¦ç†è§£â€œå˜åŸºâ€çš„æ¦‚å¿µ                                                                                                          |
| é€‚ç”¨åœºæ™¯     | é€‚åˆå°å‹å›¢é˜Ÿï¼Œæˆ–è€…å¸Œæœ›ä¿ç•™å®Œæ•´å¼€å‘å†å²çš„æƒ…å†µ                                                                            | é€‚åˆä¸ªäººå¼€å‘ï¼Œæˆ–è€…å¸Œæœ›ä¿æŒä¸»åˆ†æ”¯å†å²æ¸…æ™°çš„æƒ…å†µ                                                                                              |
| **æ³¨æ„äº‹é¡¹** | **å¦‚æœåˆ†æ”¯å·²ç»æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œå¹¶ä¸”å…¶ä»–äººåœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šå·¥ä½œï¼Œä¸è¦ç”¨ `rebase`ï¼**                                                | **å¦‚æœåˆ†æ”¯å·²ç»æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œå¹¶ä¸”å…¶ä»–äººåœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šå·¥ä½œï¼Œä¸è¦ç”¨ `rebase`ï¼**                                                                |
| **æ¯”å–»**   | **åƒä¸€æœ¬è¯¦ç»†çš„æ—¥è®°ï¼Œè®°å½•äº†æ‰€æœ‰å‘ç”Ÿçš„äº‹æƒ…**                                                                           | **åƒä¸€æ£µæ ‘ï¼Œä¸»å¹²æ¸…æ™°ï¼Œåˆ†æ”¯ä»ä¸»å¹²ç”Ÿé•¿å‡ºæ¥**                                                                                                |
| **å£è¯€**   | **`merge`è™½ä¹±å¿ƒä¸ä¹±ï¼Œ`rebase`è™½ç›´æ˜“å‡ºé”™**                                                                     | **`merge`è™½ä¹±å¿ƒä¸ä¹±ï¼Œ`rebase`è™½ç›´æ˜“å‡ºé”™**                                                                                  |

```mermaid
graph TD
    A[éœ€è¦åˆå¹¶åˆ†æ”¯] --> B{åˆ†æ”¯æ˜¯å¦å·²æ¨é€åˆ°è¿œç¨‹ï¼Ÿ}
    B -->|æ˜¯| C[å¿…é¡»ç”¨ Git Merge]
    B -->|å¦| D{æƒ³è¦æ•´æ´çš„çº¿æ€§å†å²ï¼Ÿ}
    D -->|æ˜¯| E[ä½¿ç”¨ Git Rebase]
    D -->|å¦| F[ä½¿ç”¨ Git Merge]
    
    classDef red fill:#ffe6e6,stroke:#ff6666;
    classDef green fill:#e6ffe6,stroke:#66cc66;
    class C red;
    class E green;
```

## è¶£å‘³å°ç»ƒä¹  ğŸ®

   1. **åˆ›å»ºå®éªŒç¯å¢ƒ**ï¼š

      ```bash
      git init test-project && cd test-project
      echo "Hello" > file.txt && git add . && git commit -m "Initial commit"
      git checkout -b feature  # åˆ›å»ºæ–°åˆ†æ”¯
      echo "New feature" >> file.txt && git commit -am "Add feature"
      git checkout main        # åˆ‡æ¢å›ä¸»åˆ†æ”¯
      ```

   2. **åˆ†åˆ«æ‰§è¡Œ**ï¼š

      ```bash
      # æ–¹æ¡ˆ Aï¼šmerge
       git merge feature
      # æ–¹æ¡ˆ Bï¼šrebase
      git checkout feature
      git rebase main
      git checkout main
      git merge feature
      ```  

   3. **æŸ¥çœ‹å†å²å·®å¼‚**ï¼š

      ```bash
      git log --graph --oneline  # å¯¹æ¯”ä¸¤ç§å†å²çº¿
      ```

æ€è€ƒä¸€ä¸‹ï¼Œåœ¨ä½ çš„å›¢é˜Ÿé¡¹ç›®ä¸­ï¼Œå“ªç§åˆå¹¶æ–¹å¼æ›´é€‚åˆï¼Ÿ

å¸Œæœ›è¿™ä¸ªæ–‡æ¡£èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Git Rebase å’Œ Git Mergeï¼è®°ä½ï¼Œå®è·µå‡ºçœŸçŸ¥ï¼Œå¤šåŠ¨æ‰‹è¯•è¯•ï¼Œä½ ä¼šå‘ç° Git å…¶å®å¾ˆæœ‰è¶£ï¼ğŸ˜‰
